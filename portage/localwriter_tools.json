{
  "add_comment": {
    "name": "add_comment",
    "description": "Add a comment/annotation anchored to the paragraph containing search_text.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "content": {
          "type": "string",
          "description": "The comment text."
        },
        "search_text": {
          "type": "string",
          "description": "Anchor the comment to text containing this string."
        },
        "author": {
          "type": "string",
          "description": "Author name shown on the comment. Default: AI."
        }
      },
      "required": [
        "content",
        "search_text"
      ]
    }
  },
  "delete_comment": {
    "name": "delete_comment",
    "description": "Delete a comment and all its replies by the comment's name (from list_comments).",
    "inputSchema": {
      "type": "object",
      "properties": {
        "comment_name": {
          "type": "string",
          "description": "The 'name' field returned by list_comments."
        }
      },
      "required": [
        "comment_name"
      ]
    }
  },
  "list_comments": {
    "name": "list_comments",
    "description": "List all comments/annotations in the document, including author, content, date, resolved status, and anchor preview.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": []
    }
  },
  "apply_document_content": {
    "name": "apply_document_content",
    "description": "Insert or replace content. Preferred for partial edits: target='search' with search= and content=. For whole doc: target='full'. Use target='range' with start/end.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "content": {
          "type": "string",
          "description": "The new content (Markdown or HTML)."
        },
        "target": {
          "type": "string",
          "enum": [
            "beginning",
            "end",
            "selection",
            "search",
            "full",
            "range"
          ],
          "description": "Where to apply: full, range (start+end), search (needs search), beginning, end, selection."
        },
        "start": {
          "type": "integer",
          "description": "Start character offset. Required for target 'range'."
        },
        "end": {
          "type": "integer",
          "description": "End character offset. Required for target 'range'."
        },
        "search": {
          "type": "string",
          "description": "Text to find. Required for target 'search'."
        },
        "all_matches": {
          "type": "boolean",
          "description": "Replace all occurrences (true) or first only. Default false."
        },
        "case_sensitive": {
          "type": "boolean",
          "description": "Case-sensitive search. Default true."
        }
      },
      "required": [
        "content",
        "target"
      ]
    }
  },
  "find_text": {
    "name": "find_text",
    "description": "Finds text in the document. Returns {start, end, text} per match. Use with apply_document_content (search= or target=range).",
    "inputSchema": {
      "type": "object",
      "properties": {
        "search": {
          "type": "string",
          "description": "Text to search for."
        },
        "start": {
          "type": "integer",
          "description": "Start offset to search from (default 0)."
        },
        "limit": {
          "type": "integer",
          "description": "Maximum matches to return."
        },
        "case_sensitive": {
          "type": "boolean",
          "description": "Case-sensitive search. Default true."
        }
      },
      "required": [
        "search"
      ]
    }
  },
  "get_document_content": {
    "name": "get_document_content",
    "description": "Get document (or selection/range) content. Result includes document_length. scope: full, selection, or range (requires start, end).",
    "inputSchema": {
      "type": "object",
      "properties": {
        "scope": {
          "type": "string",
          "enum": [
            "full",
            "selection",
            "range"
          ],
          "description": "Return full document (default), current selection/cursor region, or a character range (requires start and end)."
        },
        "max_chars": {
          "type": "integer",
          "description": "Maximum characters to return."
        },
        "start": {
          "type": "integer",
          "description": "Start character offset (0-based). Required for scope 'range'."
        },
        "end": {
          "type": "integer",
          "description": "End character offset (exclusive). Required for scope 'range'."
        }
      },
      "required": []
    }
  },
  "insert_at_paragraph": {
    "name": "insert_at_paragraph",
    "description": "Insert text at a specific paragraph index.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "paragraph_index": {
          "type": "integer",
          "description": "0-based paragraph index."
        },
        "text": {
          "type": "string",
          "description": "Text to insert."
        },
        "position": {
          "type": "string",
          "enum": [
            "before",
            "after",
            "replace"
          ],
          "description": "Position relative to the target paragraph (default: 'before')."
        }
      },
      "required": [
        "paragraph_index",
        "text"
      ]
    }
  },
  "read_paragraphs": {
    "name": "read_paragraphs",
    "description": "Read a range of paragraphs by index. Useful for scanning text between headings.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "start_index": {
          "type": "integer",
          "description": "Starting paragraph index (0-based)."
        },
        "count": {
          "type": "integer",
          "description": "Number of paragraphs to read (default 10)."
        }
      },
      "required": [
        "start_index"
      ]
    }
  },
  "edit_image": {
    "name": "edit_image",
    "description": "Edit the selected image using a text prompt (Img2Img). If no image is selected, it will fail.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "prompt": {
          "type": "string",
          "description": "The visual description of the desired image version."
        },
        "strength": {
          "type": "number",
          "description": "How much to change the image (0.0=none, 1.0=full). Default 0.6."
        }
      },
      "required": [
        "prompt"
      ]
    }
  },
  "generate_image": {
    "name": "generate_image",
    "description": "Generate an image from a text prompt and insert it into the document.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "prompt": {
          "type": "string",
          "description": "The visual description of the image to generate."
        },
        "width": {
          "type": "integer",
          "description": "Width in pixels (default 512)."
        },
        "height": {
          "type": "integer",
          "description": "Height in pixels (default 512)."
        }
      },
      "required": [
        "prompt"
      ]
    }
  },
  "get_document_outline": {
    "name": "get_document_outline",
    "description": "Returns the document outline (headings hierarchy).",
    "inputSchema": {
      "type": "object",
      "properties": {
        "max_depth": {
          "type": "integer",
          "description": "Maximum heading depth to return (default: all)."
        }
      },
      "required": []
    }
  },
  "get_heading_content": {
    "name": "get_heading_content",
    "description": "Returns content under a heading identified by its path (e.g. '1.2' for the second child of the first heading).",
    "inputSchema": {
      "type": "object",
      "properties": {
        "heading_path": {
          "type": "string",
          "description": "Dot-separated heading path, e.g. '1', '2.3'."
        },
        "max_paragraphs": {
          "type": "integer",
          "description": "Maximum paragraphs to return (default: 50)."
        }
      },
      "required": [
        "heading_path"
      ]
    }
  },
  "get_document_stats": {
    "name": "get_document_stats",
    "description": "Returns document statistics: character count, word count, paragraph count, page count, and heading count.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": []
    }
  },
  "get_style_info": {
    "name": "get_style_info",
    "description": "Get detailed properties of a specific style (font, size, margins, etc.).",
    "inputSchema": {
      "type": "object",
      "properties": {
        "style_name": {
          "type": "string",
          "description": "Name of the style to inspect."
        },
        "family": {
          "type": "string",
          "enum": [
            "ParagraphStyles",
            "CharacterStyles",
            "PageStyles",
            "FrameStyles",
            "NumberingStyles"
          ],
          "description": "Style family. Default: ParagraphStyles."
        }
      },
      "required": [
        "style_name"
      ]
    }
  },
  "list_styles": {
    "name": "list_styles",
    "description": "List available styles in the document. Call this before applying styles to discover exact style names.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "family": {
          "type": "string",
          "enum": [
            "ParagraphStyles",
            "CharacterStyles",
            "PageStyles",
            "FrameStyles",
            "NumberingStyles"
          ],
          "description": "Style family to list. Default: ParagraphStyles."
        }
      },
      "required": []
    }
  },
  "list_tables": {
    "name": "list_tables",
    "description": "List all text tables in the document with their names and dimensions (rows x cols).",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": []
    }
  },
  "read_table": {
    "name": "read_table",
    "description": "Read all cell contents from a named Writer table as a 2D array.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "table_name": {
          "type": "string",
          "description": "The table name from list_tables."
        }
      },
      "required": [
        "table_name"
      ]
    }
  },
  "write_table_cell": {
    "name": "write_table_cell",
    "description": "Write a value to a specific cell in a named Writer table. Use Excel-style cell references (e.g. 'A1', 'B2'). Numeric strings are stored as numbers automatically.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "table_name": {
          "type": "string",
          "description": "The table name from list_tables."
        },
        "cell": {
          "type": "string",
          "description": "Cell reference, e.g. 'A1', 'B3'."
        },
        "value": {
          "type": "string",
          "description": "The value to write."
        }
      },
      "required": [
        "table_name",
        "cell",
        "value"
      ]
    }
  },
  "accept_all_changes": {
    "name": "accept_all_changes",
    "description": "Accept all tracked changes in the document.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": []
    }
  },
  "get_tracked_changes": {
    "name": "get_tracked_changes",
    "description": "List all tracked changes (redlines) in the document, including type, author, date, and comment.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": []
    }
  },
  "reject_all_changes": {
    "name": "reject_all_changes",
    "description": "Reject all tracked changes in the document.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": []
    }
  },
  "set_track_changes": {
    "name": "set_track_changes",
    "description": "Enable or disable track changes (change recording) in the document.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "True to enable track changes, False to disable."
        }
      },
      "required": [
        "enabled"
      ]
    }
  },
  "execute_batch": {
    "name": "execute_batch",
    "description": "Execute multiple tool calls in a single request. Operations run sequentially with batch mode (cache invalidation deferred to end). Stops on first error by default. BATCH VARIABLES: $last = paragraph_index from previous step, $last+N / $last-N = offset, $last.bookmark = bookmark from previous step, $step.N = paragraph_index from step N, $step.N.bookmark = bookmark from step N. Variables resolve to integers in numeric fields, strings in text fields (e.g. locator: 'paragraph:$last+1'). Cannot call execute_batch recursively.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "operations": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "tool": {
                "type": "string",
                "description": "Tool name to execute"
              },
              "args": {
                "type": "object",
                "description": "Tool arguments. Use $last, $last+1, $step.N for paragraph chaining."
              }
            },
            "required": [
              "tool"
            ]
          },
          "description": "List of {tool, args} to execute sequentially"
        },
        "stop_on_error": {
          "type": "boolean",
          "description": "Halt on first failed operation (default: true)"
        },
        "follow": {
          "type": "string",
          "description": "Scroll the view to follow edits. 'off' = no scroll (default), 'each' = scroll after every operation, 'end' = scroll after the last operation only"
        }
      },
      "required": [
        "operations"
      ]
    }
  },
  "add_ai_summary": {
    "name": "add_ai_summary",
    "description": "Add an AI-generated summary as a comment (MCP-AI author) at a heading or paragraph. Replaces any existing MCP-AI annotation at the same location.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "locator": {
          "type": "string",
          "description": "Target location (e.g. 'bookmark:_mcp_xxx', 'paragraph:5')"
        },
        "para_index": {
          "type": "integer",
          "description": "Paragraph index (alternative to locator)"
        },
        "summary": {
          "type": "string",
          "description": "Summary text to add as annotation"
        }
      },
      "required": [
        "summary"
      ]
    }
  },
  "get_ai_summaries": {
    "name": "get_ai_summaries",
    "description": "List all MCP-AI summary annotations in the document.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": []
    }
  },
  "remove_ai_summary": {
    "name": "remove_ai_summary",
    "description": "Remove an MCP-AI summary annotation at a paragraph.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "locator": {
          "type": "string",
          "description": "Target location (e.g. 'bookmark:_mcp_xxx')"
        },
        "para_index": {
          "type": "integer",
          "description": "Paragraph index (alternative to locator)"
        }
      },
      "required": []
    }
  },
  "cleanup_bookmarks": {
    "name": "cleanup_bookmarks",
    "description": "Remove all _mcp_* bookmarks from the document. Use when bookmarks become stale after major edits.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": []
    }
  },
  "list_bookmarks": {
    "name": "list_bookmarks",
    "description": "List all bookmarks in the document with their anchor text preview. Includes both user bookmarks and _mcp_ heading bookmarks.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": []
    }
  },
  "get_surroundings": {
    "name": "get_surroundings",
    "description": "Discover objects within a radius of paragraphs around a locator. Returns nearby paragraphs, heading chain, images, tables, frames, and comments.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "locator": {
          "type": "string",
          "description": "Center position (e.g. 'bookmark:_mcp_xxx', 'paragraph:42')"
        },
        "radius": {
          "type": "integer",
          "description": "Number of paragraphs in each direction (default: 10, max: 50)"
        },
        "include": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Object types to include: paragraphs, images, tables, frames, comments, headings (default: all)"
        }
      },
      "required": [
        "locator"
      ]
    }
  },
  "navigate_heading": {
    "name": "navigate_heading",
    "description": "Navigate from a locator to a related heading. Directions: next, previous, parent, first_child, next_sibling, previous_sibling. Returns the target heading with bookmark for stable addressing.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "locator": {
          "type": "string",
          "description": "Starting position (e.g. 'bookmark:_mcp_xxx', 'paragraph:42', 'heading_text:Introduction')"
        },
        "direction": {
          "type": "string",
          "enum": [
            "next",
            "previous",
            "parent",
            "first_child",
            "next_sibling",
            "previous_sibling"
          ],
          "description": "Navigation direction"
        }
      },
      "required": [
        "locator",
        "direction"
      ]
    }
  },
  "get_page_objects": {
    "name": "get_page_objects",
    "description": "Get images, tables, and frames on a specific page. Provide page number, locator, or paragraph_index.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "page": {
          "type": "integer",
          "description": "Page number"
        },
        "locator": {
          "type": "string",
          "description": "Locator to determine page"
        },
        "paragraph_index": {
          "type": "integer",
          "description": "Paragraph index to determine page"
        }
      },
      "required": []
    }
  },
  "goto_page": {
    "name": "goto_page",
    "description": "Navigate the view cursor to a specific page.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "page": {
          "type": "integer",
          "description": "Page number to navigate to"
        }
      },
      "required": [
        "page"
      ]
    }
  },
  "list_sections": {
    "name": "list_sections",
    "description": "List all named sections in the document.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": []
    }
  },
  "refresh_indexes": {
    "name": "refresh_indexes",
    "description": "Refresh all document indexes (TOC, bibliography, etc.).",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": []
    }
  },
  "get_document_tree": {
    "name": "get_document_tree",
    "description": "Get the document heading tree with bookmarks and content previews. Creates _mcp_ bookmarks on headings for stable addressing. Content strategies: heading_only, first_lines (default), ai_summary_first, full. depth=0 for unlimited, depth=1 (default) for top-level only.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "content_strategy": {
          "type": "string",
          "enum": [
            "heading_only",
            "first_lines",
            "ai_summary_first",
            "full"
          ],
          "description": "Content to include with headings (default: first_lines)"
        },
        "depth": {
          "type": "integer",
          "description": "Max tree depth (0=unlimited, default: 1)"
        }
      },
      "required": []
    }
  },
  "get_heading_children": {
    "name": "get_heading_children",
    "description": "Drill into a heading's children \u2014 body paragraphs and sub-headings. Identify the heading by locator (e.g. 'bookmark:_mcp_xxx', 'heading_text:Title'), heading_para_index, or heading_bookmark.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "locator": {
          "type": "string",
          "description": "Locator string (e.g. 'bookmark:_mcp_xxx', 'heading:1.2')"
        },
        "heading_para_index": {
          "type": "integer",
          "description": "Paragraph index of the heading"
        },
        "heading_bookmark": {
          "type": "string",
          "description": "Bookmark name of the heading"
        },
        "content_strategy": {
          "type": "string",
          "enum": [
            "heading_only",
            "first_lines",
            "ai_summary_first",
            "full"
          ],
          "description": "Content strategy (default: first_lines)"
        },
        "depth": {
          "type": "integer",
          "description": "Max sub-heading depth (default: 1)"
        }
      },
      "required": []
    }
  },
  "get_index_stats": {
    "name": "get_index_stats",
    "description": "Get search index statistics: paragraph count, unique stems, language, build time, and top 20 most frequent stems.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": []
    }
  },
  "search_fulltext": {
    "name": "search_fulltext",
    "description": "Full-text search with Snowball stemming. Supports boolean queries: AND (default), OR, NOT, NEAR/N. Language auto-detected from document locale. Returns matching paragraphs with context and nearest heading bookmark.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "query": {
          "type": "string",
          "description": "Search query. Examples: 'climate change', 'energy AND renewable', 'solar OR wind', 'climate NOT politics', 'ocean NEAR/3 warming'"
        },
        "max_results": {
          "type": "integer",
          "description": "Maximum results to return (default: 20)"
        },
        "context_paragraphs": {
          "type": "integer",
          "description": "Paragraphs of context around each match (default: 1)"
        }
      },
      "required": [
        "query"
      ]
    }
  },
  "get_document_info": {
    "name": "get_document_info",
    "description": "Returns generic document metadata: title, file path, document type, modification status, and document properties (author, subject, etc.).",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": []
    }
  },
  "export_pdf": {
    "name": "export_pdf",
    "description": "Exports the current document to a PDF file at the given path.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "path": {
          "type": "string",
          "description": "Output PDF file path (absolute)."
        }
      },
      "required": [
        "path"
      ]
    }
  },
  "save_document": {
    "name": "save_document",
    "description": "Saves the current document. Only works if the document has already been saved to a file (has a URL). Returns an error for unsaved new documents.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": []
    }
  }
}